<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Liz Rosen" />


<title>About the Coder</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DATA 440 - Spatial Data Discovery</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="resources.html">Resources</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Discovery
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Example</li>
    <li>
      <a href="project_davis.html">Breathing of the Biosphere</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Fall 2019</li>
    <li>
      <a href="project_way.html">Children's Hospitals in U.S.</a>
    </li>
    <li>
      <a href="project_rosen.html">Climate Change &amp; Conflict</a>
    </li>
    <li>
      <a href="project_oforiaddae.html">Encroachment Into Natural Areas</a>
    </li>
    <li>
      <a href="project_chen.html">Last-Mile Delivery Network</a>
    </li>
    <li>
      <a href="project_wisdom.html">Margins of Presidential Victory</a>
    </li>
    <li>
      <a href="project_brickey.html">Tornadoes Since the 1950s</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">The Coders</li>
    <li class="divider"></li>
    <li>
      <a href="about_davis.html">dt-woods</a>
    </li>
    <li>
      <a href="about_brickey.html">mbrickey</a>
    </li>
    <li>
      <a href="about_chen.html">JiayingChen0307</a>
    </li>
    <li>
      <a href="about_oforiaddae.html">oforiaddaejnr</a>
    </li>
    <li>
      <a href="about_rosen.html">ithacalr</a>
    </li>
    <li>
      <a href="about_way.html">alway1</a>
    </li>
    <li>
      <a href="about_wisdom.html">dpwisdom</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">About the Coder</h1>
<h4 class="author"><em>Liz Rosen</em></h4>
<h4 class="date"><em>Edited: 2019-09-08</em></h4>

</div>


<div class="figure">
<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTj0SoTP-xZQHwWcURURb-FJHi6Vykt2KvFkGSIdzg9_RMPWD0BGA" title="Liz Rosen" width="150" height="150" />

</div>
<dl>
<dt>Bio</dt>
<dd>International Relations and Data Science, Class of 2020.
</dd>
<dt>My favorite things:</dt>
<dd><ol style="list-style-type: decimal">
<li>Endlessly rewatching <em>The Office</em></li>
<li>Experimenting with new recipes</li>
<li>Applying data-driven methods to IR research questions</li>
</ol>
</dd>
</dl>
<div id="sample-script" class="section level3">
<h3>Sample script</h3>
<p><a href="scripts/spreadsheet_cleaner.py">Excel Spreadsheet Cleaner (.py)</a></p>
<p>For my honors thesis, I need to convert lots of documents into spreadsheets and clean them. Sometimes, extra whitespace slips through the cracks. This script removes leading, trailing, and duplicate whitespace from .xls and .xlsx files and outputs a new, cleaned .xlsx file.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python3</span>
<span class="co">#</span>
<span class="co"># VERSION 0.1</span>
<span class="co">#</span>
<span class="co"># LAST EDIT: 2019-09-16</span>
<span class="co">#</span>
<span class="co"># This script removes leading, trailing, and duplicate spaces in</span>
<span class="co"># .xls and .xlsx files and creates a new .xlsx file</span>
<span class="co">#</span>
<span class="co">##############################################################################</span>
<span class="co"># REQUIRED MODULES</span>
<span class="co">##############################################################################</span>
<span class="im">import</span> pandas <span class="im">as</span> pd
<span class="im">import</span> os
<span class="im">import</span> re
<span class="im">import</span> sys
<span class="co">##############################################################################</span>
<span class="co"># FUNCTIONS</span>
<span class="co">##############################################################################</span>
<span class="kw">def</span> show_help():
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Name:     show_help</span>
<span class="co">    Inputs:   None</span>
<span class="co">    Outputs:  None</span>
<span class="co">    Features: Prints the help text when user uses the &#39;-h&#39; command flag</span>
<span class="co">    &quot;&quot;&quot;</span>
    help_txt <span class="op">=</span> (<span class="st">&quot;FILE: </span><span class="ch">\t</span><span class="st"> spreadsheet_cleaner.py</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;DESC: </span><span class="ch">\t</span><span class="st"> Removes leading, trailing, and duplicate spaces</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;</span><span class="ch">\t</span><span class="st"> in .xlsx and .xls files in a given directory.</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;</span><span class="ch">\t</span><span class="st"> User will be prompted for path to directory</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;</span><span class="ch">\t</span><span class="st"> containing Excel files.</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;NOTE: </span><span class="ch">\t</span><span class="st"> Do not run on files that are currently open.</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;USGE: </span><span class="ch">\t</span><span class="st"> app_name [options]</span><span class="ch">\n</span><span class="st">&quot;</span>
                <span class="st">&quot;</span><span class="ch">\t</span><span class="st"> -h, --help   shows the help text</span><span class="ch">\n</span><span class="st">&quot;</span>)
    <span class="bu">print</span>(help_txt)


<span class="co">##############################################################################</span>
<span class="co"># CLASSES</span>
<span class="co">##############################################################################</span>
<span class="kw">class</span> SpreadSheet(<span class="bu">object</span>):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Name:     SpreadSheet</span>
<span class="co">    Features: Class for cleaning Excel files</span>
<span class="co">    History:  Version 0.1</span>
<span class="co">              - Written for class</span>
<span class="co">              - Intended to help with Honors data cleaning</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="co"># \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
    <span class="co"># Class Parameters</span>
    <span class="co"># ////////////////////////////////////////////////////////////////////////</span>
    <span class="co"># None</span>

    <span class="co"># \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
    <span class="co"># Class Initialization</span>
    <span class="co"># ////////////////////////////////////////////////////////////////////////</span>
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, base_dir):
        <span class="co">&quot;&quot;&quot;</span>
<span class="co">        Name:       SpreadSheet.__init__</span>
<span class="co">        Inputs:     str, base directory (base_dir)</span>
<span class="co">        Features:   Initializes the SpreadSheet class</span>
<span class="co">        Reference:  Way of checking directory is from Prof. Davis&#39;s music_randomizer</span>
<span class="co">        &quot;&quot;&quot;</span>
        <span class="co"># Intitialize class variables:</span>
        <span class="va">self</span>.file_list <span class="op">=</span> []
        <span class="cf">if</span> os.path.isdir(base_dir):
            <span class="va">self</span>.base_dir <span class="op">=</span> base_dir
        <span class="cf">else</span>:
            <span class="va">self</span>.base_dir <span class="op">=</span> <span class="va">None</span>
            <span class="cf">raise</span> <span class="pp">OSError</span>(<span class="st">&quot;Directory &#39;</span><span class="sc">%s</span><span class="st">&#39; does not exist&quot;</span> <span class="op">%</span> (base_dir))

    <span class="co"># \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
    <span class="co"># Class Property Definitions</span>
    <span class="co"># ////////////////////////////////////////////////////////////////////////</span>
    <span class="co"># None</span>

    <span class="co"># \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
    <span class="co"># Class Function Definitions</span>
    <span class="co"># ////////////////////////////////////////////////////////////////////////</span>
    <span class="kw">def</span> cleaning(<span class="va">self</span>, <span class="bu">file</span>, name):
        <span class="co">&quot;&quot;&quot;</span>
<span class="co">        Name:       SpreadSheet.cleaning</span>
<span class="co">        Inputs:     Excel file</span>
<span class="co">        Outputs:    New, clean .xlsx file</span>
<span class="co">        Features:   Removes whitespace and duplicate spaces from pd dataframes and saves new file.</span>
<span class="co">        Reference:  https://stackoverflow.com/questions/1546226/simple-way-to-remove-multiple-spaces-in-a-string/1546244</span>
<span class="co">        &quot;&quot;&quot;</span>
        data <span class="op">=</span> pd.read_excel(<span class="bu">file</span>, index_col<span class="op">=</span><span class="va">None</span>, header<span class="op">=</span><span class="dv">0</span>)
        col_names <span class="op">=</span> <span class="bu">list</span>(data.columns)
        <span class="cf">for</span> col <span class="kw">in</span> col_names:
            data[col] <span class="op">=</span> data[col].astype(<span class="bu">str</span>)
            data[col] <span class="op">=</span> data[col].<span class="bu">str</span>.strip()
            data[col] <span class="op">=</span> data[col].<span class="bu">str</span>.replace(<span class="st">&#39;[ </span><span class="ch">\t\n\r</span><span class="st">]+&#39;</span>, <span class="st">&quot; &quot;</span>)
        writer <span class="op">=</span> pd.ExcelWriter(name, engine<span class="op">=</span><span class="st">&#39;xlsxwriter&#39;</span>)
        data.to_excel(writer, index<span class="op">=</span><span class="va">False</span>)
        writer.save()

    <span class="kw">def</span> get_files(<span class="va">self</span>, base_dir):
        <span class="co">&quot;&quot;&quot;</span>
<span class="co">        Name:     SpreadSheet.get_files</span>
<span class="co">        Inputs:   None.</span>
<span class="co">        Outputs:  None.</span>
<span class="co">        Features: Creates a list of .xls and .xlsx files in the base directory</span>
<span class="co">        Reference: https://stackoverflow.com/questions/10377998/how-can-i-iterate-over-files-in-a-given-directory</span>
<span class="co">        &quot;&quot;&quot;</span>
        directory <span class="op">=</span> base_dir
        <span class="co"># have already checked if directory exists.</span>
        <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(directory):
            <span class="cf">if</span> filename.endswith(<span class="st">&quot;.xls&quot;</span>) <span class="kw">or</span> filename.endswith(<span class="st">&quot;.xlsx&quot;</span>):
                <span class="va">self</span>.file_list.append(os.path.join(directory, filename))
            <span class="cf">else</span>:
                <span class="cf">continue</span>

    <span class="kw">def</span> run(<span class="va">self</span>, base_dir):
        <span class="co">&quot;&quot;&quot;</span>
<span class="co">        Name:       SpreadSheet.run</span>
<span class="co">        Inputs:     file (from get_files), col_names (from get_columns)</span>
<span class="co">        Outputs:    Clean files</span>
<span class="co">        Features:   Cleans Excel files and returns renamed files</span>
<span class="co">        Reference:</span>
<span class="co">        &quot;&quot;&quot;</span>
        <span class="va">self</span>.get_files(base_dir)
        <span class="cf">for</span> file_name <span class="kw">in</span> <span class="va">self</span>.file_list:
            names <span class="op">=</span> <span class="bu">str</span>(file_name).split(<span class="st">&quot;.&quot;</span>)
            new_name <span class="op">=</span> <span class="st">&quot;.&quot;</span> <span class="op">+</span> <span class="bu">str</span>(names[<span class="dv">1</span>]) <span class="op">+</span> <span class="st">&quot;_tidy.&quot;</span> <span class="op">+</span> <span class="bu">str</span>(names[<span class="dv">2</span>])
            <span class="va">self</span>.cleaning(file_name, new_name)

<span class="co">##############################################################################</span>
<span class="co"># MAIN</span>
<span class="co">##############################################################################</span>
<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    <span class="cf">if</span> <span class="st">&#39;-h&#39;</span> <span class="kw">in</span> sys.argv <span class="kw">or</span> <span class="st">&#39;--help&#39;</span> <span class="kw">in</span> sys.argv:
        show_help()
    <span class="cf">else</span>:
        input_path <span class="op">=</span> <span class="bu">str</span>(<span class="bu">input</span>(<span class="st">&quot;Type path to directory: &quot;</span>))
        utility <span class="op">=</span> SpreadSheet(input_path)
        utility.run(input_path)</code></pre></div>
</div>

<footer class="myfoot">
    <div class="foot-text">
        <p>Data Science at William &amp; Mary (2019)</p>
    </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
